<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Galería de Medios</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .media-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 0;
            list-style: none;
        }
        .media-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .media-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        .file-name {
            font-weight: bold;
            color: #555;
            margin-bottom: 10px;
            word-break: break-all;
        }
        .media-preview {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            background: #e9ecef;
            border-radius: 4px;
        }
        .media-icon {
            font-size: 48px;
            margin-bottom: 10px;
        }
        .refresh-btn {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-bottom: 20px;
        }
        .refresh-btn:hover {
            background: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Galería de Medios</h1>
        <button class="refresh-btn" onclick="loadFiles()">🔄 Actualizar</button>
        <ul class="media-gallery" id="mediaGallery">
            <!-- Los medios se cargarán dinámicamente aquí -->
        </ul>
    </div>

    <!-- Cargar lista de archivos externa -->
    <script src="files.js"></script>
    
    <script>
        function isMediaFile(fileName) {
            const ext = fileName.split('.').pop().toLowerCase();
            return ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg', 'mp4', 'mov', 'avi', 'mp3', 'wav', 'ogg'].includes(ext);
        }

        function isImage(fileName) {
            const ext = fileName.split('.').pop().toLowerCase();
            return ['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp', 'svg'].includes(ext);
        }

        function isVideo(fileName) {
            const ext = fileName.split('.').pop().toLowerCase();
            return ['mp4', 'mov', 'avi', 'webm', 'mkv'].includes(ext);
        }

        function isAudio(fileName) {
            const ext = fileName.split('.').pop().toLowerCase();
            return ['mp3', 'wav', 'ogg', 'flac', 'm4a'].includes(ext);
        }

        function loadFiles() {
            const mediaGallery = document.getElementById('mediaGallery');
            mediaGallery.innerHTML = '';

            // Verificar que la lista de archivos esté cargada
            if (typeof files === 'undefined') {
                mediaGallery.innerHTML = '<li style="text-align: center; color: #666; padding: 40px;">Error: No se pudo cargar la lista de archivos</li>';
                return;
            }

            // Filtrar solo archivos multimedia
            const mediaFiles = files.filter(fileName => isMediaFile(fileName));

            if (mediaFiles.length === 0) {
                mediaGallery.innerHTML = '<li style="text-align: center; color: #666; padding: 40px;">No se encontraron archivos multimedia</li>';
                return;
            }

            mediaFiles.forEach(fileName => {
                const listItem = document.createElement('li');
                listItem.className = 'media-item';
                
                let mediaContent = '';
                
                if (isImage(fileName)) {
                    mediaContent = `
                    <img src="${fileName}" alt="${fileName}" class="media-preview" onerror="this.style.display='none'">
                    <div class="file-name">${fileName}</div>
                    `;
                } else if (isVideo(fileName)) {
                    mediaContent = `
                        <div class="file-name">${fileName}</div>
                        <div class="media-icon">🎥</div>
                        <video controls class="media-preview">
                            <source src="${fileName}" type="video/${fileName.split('.').pop()}">
                            Tu navegador no soporta este video.
                        </video>
                    `;
                } else if (isAudio(fileName)) {
                    mediaContent = `
                        <div class="file-name">${fileName}</div>
                        <div class="media-icon">🎵</div>
                        <audio controls style="width: 100%;">
                            <source src="${fileName}" type="audio/${fileName.split('.').pop()}">
                            Tu navegador no soporta este audio.
                        </audio>
                    `;
                }
                
                listItem.innerHTML = mediaContent;
                mediaGallery.appendChild(listItem);
            });

            // Actualizar timestamp
            const timestamp = document.getElementById('timestamp');
            if (timestamp) {
                timestamp.textContent = new Date().toLocaleString('es-ES');
            } else {
                const timestampDiv = document.createElement('div');
                timestampDiv.id = 'timestamp';
                timestampDiv.style.textAlign = 'center';
                timestampDiv.style.marginTop = '20px';
                timestampDiv.style.color = '#666';
                timestampDiv.textContent = `Última actualización: ${new Date().toLocaleString('es-ES')}`;
                document.querySelector('.container').appendChild(timestampDiv);
            }
        }

        // Cargar archivos al inicio
        document.addEventListener('DOMContentLoaded', loadFiles);

        // Auto-refresh cada 30 segundos
        setInterval(loadFiles, 30000);
    </script>
</body>
</html>